package main

import (
	"fmt"
	"log"
	"math/rand"
	"time"
)

//import _ "net/http/pprof"

func main() {
	//go func() {
	//	log.Println(http.ListenAndServe("localhost:6060", nil))
	//}()
	rand.Seed(time.Now().UnixNano())

	instance_tai20a := readInstance("./instances/tai20a")
	//fmt.Println(calcCost([]int{0, 8, 11, 14, 3, 7, 9, 4, 18, 12, 2, 13, 5, 19, 17, 6, 1, 16, 10, 15}, instance_tai20a))
	//fmt.Println(calcCost([]int{8, 0, 4, 3, 2, 9, 7, 12, 1, 10, 6, 14, 19, 11, 17, 15, 13, 16, 18, 5}, instance_tai20a))
	//fmt.Println(calcCost([]int{7, 0, 15, 4, 2, 19, 8, 9, 1, 18, 13, 17, 14, 12, 3, 10, 5, 16, 11, 6}, instance_tai20a))
	//fmt.Println(calcCost([]int{10, 17, 6, 13, 8, 11, 16, 2, 14, 15, 18, 0, 12, 19, 1, 9, 5, 7, 3, 4}, instance_tai20a))

	fmt.Println(calcCost([]int{18, 7, 0, 1, 5, 17, 19, 9, 12, 16, 10, 13, 6, 2, 11, 15, 3, 4, 14, 8}, instance_tai20a))
	start := time.Now()
	//Solve(instance_tai20a)
	fmt.Println(time.Since(start))

	instance_tai40a := readInstance("./instances/tai40a")
	//fmt.Println(calcCost([]int{27, 10, 8, 28, 14, 26, 30, 4, 1, 16, 12, 7, 36, 34, 23, 35, 2, 6, 31, 9, 17, 32, 0, 38, 29, 13, 20, 18, 5, 22, 25, 33, 19, 39, 37, 24, 3, 11, 15, 21}, instance_tai40a))
	//fmt.Println(calcCost([]int{12, 6, 8, 33, 29, 38, 24, 13, 17, 37, 23, 4, 11, 32, 2, 19, 1, 16, 9, 25, 22, 36, 0, 3, 15, 14, 10, 35, 5, 27, 30, 26, 28, 39, 20, 18, 31, 7, 21, 34}, instance_tai40a))

	fmt.Println(calcCost([]int{1, 36, 27, 33, 14, 7, 22, 30, 16, 23, 28, 12, 32, 25, 31, 26, 21, 15, 10, 3, 11, 18, 29, 17, 19, 0, 39, 35, 8, 38, 9, 4, 6, 13, 20, 2, 5, 34, 37, 24}, instance_tai40a))
	start = time.Now()
	//Solve(instance_tai40a)
	fmt.Println(time.Since(start))

	instance_tai60a := readInstance("./instances/tai60a")
	//fmt.Println(calcCost([]int{41, 59, 42, 36, 9, 8, 24, 22, 33, 26, 50, 12, 10, 15, 29, 55, 13, 14, 0, 44, 34, 56, 30, 48, 39, 51, 37, 27, 25, 32, 23, 47, 57, 5, 38, 45, 3, 54, 53, 40, 6, 43, 11, 18, 52, 19, 2, 1, 4, 21, 31, 46, 49, 35, 7, 20, 16, 17, 28, 58}, instance_tai60a))
	//fmt.Println(calcCost([]int{29, 52, 38, 46, 6, 20, 19, 16, 31, 14, 48, 15, 30, 21, 26, 25, 35, 9, 53, 34, 28, 2, 40, 18, 37, 43, 44, 51, 17, 22, 49, 50, 13, 41, 3, 45, 7, 33, 12, 58, 23, 11, 0, 24, 59, 1, 55, 10, 32, 8, 54, 4, 39, 57, 47, 5, 27, 36, 42, 56}, instance_tai60a))

	fmt.Println(calcCost([]int{16, 37, 42, 43, 11, 44, 0, 15, 35, 49, 52, 53, 54, 28, 48, 32, 36, 41, 6, 4, 34, 2, 58, 1, 5, 51, 21, 25, 45, 57, 24, 30, 3, 8, 13, 46, 22, 40, 18, 38, 27, 59, 26, 50, 55, 47, 9, 10, 29, 23, 7, 31, 20, 14, 33, 19, 56, 39, 12, 17}, instance_tai60a))
	start = time.Now()
	//Solve(instance_tai60a)
	fmt.Println(time.Since(start))

	instance_tai80a := readInstance("./instances/tai80a")
	//fmt.Println(calcCost([]int{35, 66, 59, 12, 62, 39, 68, 8, 78, 53, 58, 65, 13, 26, 44, 43, 28, 11, 9, 18, 77, 30, 23, 7, 74, 48, 63, 64, 17, 25, 22, 33, 79, 1, 75, 67, 6, 40, 46, 29, 10, 16, 55, 69, 71, 57, 31, 51, 60, 27, 24, 70, 15, 41, 47, 20, 37, 45, 54, 50, 5, 32, 3, 73, 76, 38, 19, 49, 2, 52, 42, 56, 61, 72, 36, 4, 34, 14, 21, 0}, instance_tai80a))
	//fmt.Println(calcCost([]int{6, 10, 15, 56, 64, 47, 31, 63, 78, 43, 0, 39, 69, 12, 55, 26, 17, 46, 74, 9, 7, 49, 42, 67, 3, 1, 20, 73, 57, 16, 18, 68, 23, 8, 32, 24, 2, 62, 27, 29, 33, 60, 77, 75, 13, 44, 41, 11, 79, 40, 30, 51, 36, 53, 25, 71, 4, 34, 76, 48, 28, 19, 72, 5, 65, 54, 70, 66, 52, 50, 22, 21, 61, 37, 59, 35, 45, 58, 14, 38}, instance_tai80a))

	fmt.Println(calcCost([]int{42, 65, 27, 9, 47, 56, 69, 57, 34, 71, 24, 25, 41, 11, 67, 8, 38, 46, 13, 7, 23, 35, 36, 63, 37, 10, 0, 51, 58, 53, 49, 26, 20, 40, 76, 4, 54, 29, 18, 66, 60, 61, 31, 52, 5, 59, 68, 2, 43, 45, 64, 72, 15, 14, 48, 44, 16, 74, 33, 12, 32, 21, 22, 62, 1, 19, 39, 77, 75, 78, 17, 79, 70, 6, 50, 30, 28, 3, 55, 73}, instance_tai80a))
	start = time.Now()
	//Solve(instance_tai80a)
	fmt.Println(time.Since(start))

	instance_tai100a := readInstance("./instances/tai100a")
	//fmt.Println(calcCost([]int{33, 81, 23, 5, 40, 4, 79, 73, 41, 36, 16, 20, 44, 12, 74, 84, 80, 21, 77, 42, 88, 67, 48, 91, 49, 68, 0, 50, 71, 87, 28, 53, 96, 86, 52, 24, 70, 3, 66, 39, 75, 9, 83, 64, 82, 19, 37, 1, 38, 63, 30, 59, 46, 76, 14, 13, 89, 69, 11, 56, 29, 58, 57, 72, 61, 54, 43, 7, 47, 10, 62, 90, 45, 32, 51, 17, 85, 35, 55, 97, 78, 93, 22, 99, 18, 94, 98, 8, 65, 2, 31, 95, 92, 26, 27, 15, 25, 34, 6, 60}, instance_tai100a))
	//fmt.Println(calcCost([]int{96, 45, 13, 54, 17, 53, 25, 31, 21, 12, 87, 99, 3, 94, 82, 42, 6, 73, 5, 44, 71, 61, 49, 30, 67, 11, 76, 79, 24, 37, 41, 1, 16, 58, 69, 43, 22, 19, 7, 50, 98, 9, 88, 34, 55, 38, 23, 89, 74, 92, 77, 91, 75, 8, 51, 15, 65, 60, 70, 93, 40, 32, 97, 59, 63, 78, 62, 28, 0, 47, 14, 90, 83, 56, 95, 27, 52, 84, 39, 10, 35, 36, 64, 57, 72, 86, 81, 46, 26, 48, 29, 68, 18, 80, 66, 33, 2, 20, 85, 4}, instance_tai100a))

	fmt.Println(calcCost([]int{20, 9, 92, 90, 5, 55, 32, 24, 59, 66, 38, 44, 54, 39, 40, 23, 69, 56, 47, 26, 29, 3, 70, 41, 2, 18, 31, 85, 22, 53, 75, 27, 96, 19, 35, 99, 0, 34, 77, 93, 64, 95, 73, 60, 62, 30, 98, 21, 61, 50, 82, 71, 89, 76, 78, 84, 33, 74, 10, 68, 46, 80, 1, 58, 28, 14, 88, 63, 51, 94, 37, 81, 65, 57, 42, 16, 87, 45, 25, 79, 72, 49, 17, 67, 13, 91, 36, 15, 12, 97, 52, 7, 6, 11, 43, 4, 8, 86, 83, 48}, instance_tai100a))
	start = time.Now()
	//Solve(instance_tai100a)
	fmt.Println(time.Since(start))
}

func readInstance(path string) *Instance {
	instance := new(Instance)
	err := instance.Read(path)
	if err != nil {
		log.Fatal(err)
	}
	return instance
}
